<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Motif enrichment using AME — runAme.list • memes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Motif enrichment using AME — runAme.list"><meta property="og:description" content="AME identifies known motifs (provided by the user) that are enriched in your input sequences."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">memes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/install_guide.html">Install MEME</a>
    </li>
    <li>
      <a href="../articles/core_dreme.html">De-Novo Motif Discovery</a>
    </li>
    <li>
      <a href="../articles/core_tomtom.html">Motif Comparison</a>
    </li>
    <li>
      <a href="../articles/core_ame.html">Motif Enrichment</a>
    </li>
    <li>
      <a href="../articles/core_fimo.html">Motif Scanning</a>
    </li>
    <li>
      <a href="../articles/tidy_motifs.html">Motif Manipulation</a>
    </li>
    <li>
      <a href="../articles/integrative_analysis.html">ChIP-Seq Data Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/snystrom/memes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Motif enrichment using AME</h1>
    <small class="dont-index">Source: <a href="https://github.com/snystrom/memes/blob/HEAD/R/ame.R" class="external-link"><code>R/ame.R</code></a>, <a href="https://github.com/snystrom/memes/blob/HEAD/R/generics.R" class="external-link"><code>R/generics.R</code></a></small>
    <div class="hidden name"><code>runAme.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>AME identifies known motifs (provided by the user) that are enriched in your input sequences.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S3 method for list</span>
<span class="fu">runAme</span><span class="op">(</span>
  <span class="va">input</span>,
  control <span class="op">=</span> <span class="st">"shuffle"</span>,
  outdir <span class="op">=</span> <span class="st">"auto"</span>,
  method <span class="op">=</span> <span class="st">"fisher"</span>,
  database <span class="op">=</span> <span class="cn">NULL</span>,
  meme_path <span class="op">=</span> <span class="cn">NULL</span>,
  sequences <span class="op">=</span> <span class="cn">FALSE</span>,
  silent <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for BStringSetList</span>
<span class="fu">runAme</span><span class="op">(</span>
  <span class="va">input</span>,
  control <span class="op">=</span> <span class="st">"shuffle"</span>,
  outdir <span class="op">=</span> <span class="st">"auto"</span>,
  method <span class="op">=</span> <span class="st">"fisher"</span>,
  database <span class="op">=</span> <span class="cn">NULL</span>,
  meme_path <span class="op">=</span> <span class="cn">NULL</span>,
  sequences <span class="op">=</span> <span class="cn">FALSE</span>,
  silent <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">runAme</span><span class="op">(</span>
  <span class="va">input</span>,
  control <span class="op">=</span> <span class="st">"shuffle"</span>,
  outdir <span class="op">=</span> <span class="st">"auto"</span>,
  method <span class="op">=</span> <span class="st">"fisher"</span>,
  database <span class="op">=</span> <span class="cn">NULL</span>,
  meme_path <span class="op">=</span> <span class="cn">NULL</span>,
  sequences <span class="op">=</span> <span class="cn">FALSE</span>,
  silent <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">runAme</span><span class="op">(</span>
  <span class="va">input</span>,
  control <span class="op">=</span> <span class="st">"shuffle"</span>,
  outdir <span class="op">=</span> <span class="st">"auto"</span>,
  method <span class="op">=</span> <span class="st">"fisher"</span>,
  database <span class="op">=</span> <span class="cn">NULL</span>,
  meme_path <span class="op">=</span> <span class="cn">NULL</span>,
  sequences <span class="op">=</span> <span class="cn">FALSE</span>,
  silent <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>input</dt>
<dd><p>path to fasta, or DNAstringset (optional: DNAStringSet object
names contain fasta score, required for partitioning mode)</p></dd>
<dt>control</dt>
<dd><p>default: "shuffle", or set to
DNAstringset or path to fasta file to use those sequences in discriminative
mode. If <code>input</code> is a list of DNAStringSet objects, and <code>control</code> is set to
a character vector of names in <code>input</code>, those regions will be used as
background in discriminitive mode and AME will skip running on any
<code>control</code> entries (NOTE: if <code>input</code> contains an entry named "shuffle" and
control is set to "shuffle", it will use the <code>input</code> entry, not the AME
shuffle algorithm). If <code>control</code> is a Biostrings::BStringSetList (generated
using <code>get_sequence</code>), all sequences in the list will be combined as the
control set. Set to <code>NA</code> for partitioning based on input fasta score (see
<code><a href="get_sequence.html">get_sequence()</a></code> for assigning fasta score). If input sequences are not
assigned fasta scores but AME is run in partitioning mode, the sequence
order will be used as the score.</p></dd>
<dt>outdir</dt>
<dd><p>Path to output directory location to save data files. If set to "auto",
will use location of input files if passing file paths, otherwise will
write to a temporary directory. default: "auto"</p></dd>
<dt>method</dt>
<dd><p>default: fisher (allowed values: fisher, ranksum, pearson, spearman, 3dmhg, 4dmhg)</p></dd>
<dt>database</dt>
<dd><p>path to .meme format file, universalmotif list object, dreme
results data.frame, or list() of multiple of these. If objects are assigned names in the list,
that name will be used as the database id in the output. It is highly
recommended you set a name if not using a file path so the database name
will be informative, otherwise the position in the list will be used as the
database id. For example, if the input is: list("motifs.meme",
list_of_motifs), the database id's will be: "motifs.meme" and "2". If the
input is list("motifs.meme", "customMotifs" = list_of_motifs), the database
id's will be "motifs.meme" and "customMotifs".</p></dd>
<dt>meme_path</dt>
<dd><p>path to "meme/bin/" (default: <code>NULL</code>). Will use default
search behavior as described in <code><a href="check_meme_install.html">check_meme_install()</a></code> if unset.</p></dd>
<dt>sequences</dt>
<dd><p><code>logical(1)</code> add results from <code>sequences.tsv</code> to <code>sequences</code>
list column to returned data.frame. Valid only if method = "fisher". See
<a href="http://alternate.meme-suite.org/doc/ame-output-format.html" class="external-link">AME outputs</a>
webpage for more information (Default: FALSE).</p></dd>
<dt>silent</dt>
<dd><p>whether to suppress stdout (default: TRUE), useful for debugging.</p></dd>
<dt>...</dt>
<dd><p>additional arguments passed to AME (see AME Flag table below)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a data.frame of AME enrichment results. If run using a BStringsSetList
input, returns a list of data.frames.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>AME can be run using several modes:</p><ol><li><p>Discriminative mode: to discover motifs enriched relative to shuffled
input, or a set of provided control sequences</p></li>
<li><p>Partitioning mode: in which AME uses some biological signal to identify
the association between the signal and motif presence.</p></li>
</ol><p>To read more about how AME works, see the <a href="http://meme-suite.org/doc/ame-tutorial.html" class="external-link">AME Tutorial</a></p>
<p>Additional AME arguments</p>
<p>memes allows passing any valid flag to it's target programs via <code>...</code>. For
additional details for all valid AME arguments, see the <a href="http://meme-suite.org/doc/ame.html" class="external-link">AME Manual</a> webpage. For convenience, a table
of valid parameters, and brief descriptions of their function are provided
below:</p><table class="table table"><tr><td>AME Flag</td><td>allowed values</td><td>default</td><td>description</td></tr><tr><td>kmer</td><td><code>integer(1)</code></td><td>2</td><td>kmer frequency to preserve when shuffling control sequences</td></tr><tr><td>seed</td><td><code>integer(1)</code></td><td>1</td><td>seed for random number generator when shuffling control sequences</td></tr><tr><td>scoring</td><td>"avg", "max", "sum", "totalhits"</td><td>"avg"</td><td>Method for scoring a sequence for matches to a PWM (avg, max, sum, totalhits)</td></tr><tr><td>hit_lo_fraction</td><td><code>numeric(1)</code></td><td>0.25</td><td>fraction of hit log odds score to exceed to be considered a "hit"</td></tr><tr><td>evalue_report_threshold</td><td><code>numeric(1)</code></td><td>10</td><td>E-value threshold for reporting a motif as significantly enriched</td></tr><tr><td>fasta_threshold</td><td><code>numeric(1)</code></td><td>0.001</td><td>AME will classify sequences with FASTA scores below this value as positives. Only valid when <code>method = "fisher", poslist = "pwm", control = NA, fix_partition = NULL</code>.</td></tr><tr><td>fix_partition</td><td><code>numeric(1)</code></td><td><code>NULL</code></td><td>AME evaluates only the partition of the first N sequences. Only works when <code>control = NA</code> and <code>poslist = "fasta"</code></td></tr><tr><td>poslist</td><td>"pwm", "fasta"</td><td>"fasta"</td><td>When using paritioning mode (<code>control = NA</code>), test thresholds on either PWM or Fasta score</td></tr><tr><td>log_fscores</td><td><code>logical(1)</code></td><td>FALSE</td><td>Convert FASTA scores into log-space (only used when <code>method = "pearson"</code>)</td></tr><tr><td>log_pwmscores</td><td><code>logical(1)</code></td><td>FALSE</td><td>Convert PWM scores into log-space (only used for <code>method = "pearson"</code> or <code>method = "spearman</code>)</td></tr><tr><td>lingreg_switchxy</td><td><code>logical(1)</code></td><td>FALSE</td><td>Make the x-points FASTA scores and y-points PWM scores (only used for <code>method = "pearson"</code> or <code>method = "spearman</code>)</td></tr><tr><td>xalph</td><td>file path</td><td><code>NULL(1)</code></td><td>alphabet file to use if input motifs are in different alphabet than input sequences</td></tr><tr><td>bfile</td><td>"motif", "motif-file", "uniform", path to file</td><td><code>NULL</code></td><td>source of 0-order background model. If "motif" or "motif-file" 0-order letter frequencies in the first motif file are used. If "uniform" uses uniform letter frequencies.</td></tr><tr><td>motif_pseudo</td><td><code>numeric(1)</code></td><td>0.1</td><td>Addd this pseudocount when converting from frequency matrix to log-odds matrix</td></tr><tr><td>inc</td><td><code>character(1)</code></td><td><code>NULL</code></td><td>use only motifs with names matching this regex</td></tr><tr><td>exc</td><td><code>character(1)</code></td><td><code>NULL</code></td><td>exclude motifs with names matching this regex</td></tr></table></div>
    <div id="citation">
    <h2>Citation</h2>
    <p>If you use <code>runAme()</code> in your analysis, please cite:</p>
<p>Robert McLeay and Timothy L. Bailey, "Motif Enrichment Analysis: A unified
framework and method evaluation", BMC Bioinformatics, 11:165, 2010,
doi:10.1186/1471-2105-11-165. <a href="http://www.biomedcentral.com/1471-2105/11/165" class="external-link">full text</a></p><div class="section">
<h3 id="licensing">Licensing<a class="anchor" aria-label="anchor" href="#licensing"></a></h3>


<p>The MEME Suite is free for non-profit use, but for-profit users should purchase a
license. See the <a href="http://meme-suite.org/doc/copyright.html" class="external-link">MEME Suite Copyright Page</a> for details.</p>
</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="meme_is_installed.html">meme_is_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Create random named sequences as input for example</span></span>
<span class="r-in"><span class="va">seqs</span> <span class="op">&lt;-</span> <span class="fu">universalmotif</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/universalmotif/man/create_sequences.html" class="external-link">create_sequences</a></span><span class="op">(</span>rng.seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># An example path to a motif database file in .meme format</span></span>
<span class="r-in"><span class="va">motif_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"flyFactorSurvey_cleaned.meme"</span>, package <span class="op">=</span> <span class="st">"memes"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">runAme</span><span class="op">(</span><span class="va">seqs</span>, database <span class="op">=</span> <span class="va">motif_file</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Dreme results dataset for example</span></span>
<span class="r-in"><span class="va">dreme_xml</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"dreme.xml"</span>, package <span class="op">=</span> <span class="st">"memes"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dreme_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="importDremeXML.html">importDremeXML</a></span><span class="op">(</span><span class="va">dreme_xml</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># database can be set to multiple values like so: </span></span>
<span class="r-in"><span class="fu">runAme</span><span class="op">(</span><span class="va">seqs</span>, database <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">motif_file</span>, <span class="st">"my_dreme_motifs"</span> <span class="op">=</span> <span class="va">dreme_results</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> AME detected no enrichment</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> AME detected no enrichment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Spencer Nystrom.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

