<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Motif Comparison using TomTom • memes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Motif Comparison using TomTom">
<meta property="og:description" content="memes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">memes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/install_guide.html">Install MEME</a>
    </li>
    <li>
      <a href="../articles/core_dreme.html">De-Novo Motif Discovery</a>
    </li>
    <li>
      <a href="../articles/core_tomtom.html">Motif Comparison</a>
    </li>
    <li>
      <a href="../articles/core_ame.html">Motif Enrichment</a>
    </li>
    <li>
      <a href="../articles/core_fimo.html">Motif Scanning</a>
    </li>
    <li>
      <a href="../articles/tidy_motifs.html">Motif Manipulation</a>
    </li>
    <li>
      <a href="../articles/integrative_analysis.html">ChIP-Seq Data Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/snystrom/memes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="core_tomtom_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Motif Comparison using TomTom</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/snystrom/memes/blob/master/vignettes/core_tomtom.Rmd" class="external-link"><code>vignettes/core_tomtom.Rmd</code></a></small>
      <div class="hidden name"><code>core_tomtom.Rmd</code></div>

    </div>

    
    
<p>TomTom is a tool for comparing motifs to a known set of motifs. It takes as input a set of motifs and a database of known motifs to return a ranked list of the significance of the match between the input and known motifs. TomTom can be run using the <code><a href="../reference/runTomTom.html">runTomTom()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://snystrom.github.io/memes/" class="external-link">memes</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></code></pre></div>
<div id="accepted-database-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#accepted-database-formats" class="anchor"></a>Accepted database formats</h2>
<p><code><a href="../reference/runTomTom.html">runTomTom()</a></code> can accept a variety of inputs to use as the “known” motif database. The formats are as follows: - a path to a .meme format file (eg <code>"fly_factor_survey.meme"</code>) - a list of universalmotifs - the output object from <code><a href="../reference/runDreme.html">runDreme()</a></code> - a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of all the above. If entries are named, <code><a href="../reference/runTomTom.html">runTomTom()</a></code> will use those names as the database identifier</p>
<div id="setting-a-default-database" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-a-default-database" class="anchor"></a>Setting a default database</h3>
<p>memes can be configured to use a default .meme format file as the query database, which it will use if the user does not provide a value to <code>database</code> when calling <code><a href="../reference/runTomTom.html">runTomTom()</a></code>. The following locations will be searched in order:</p>
<ol style="list-style-type: decimal">
<li>The <code>meme_db</code> option, defined using <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options(meme_db = "path/to/database.meme")</a></code>
</li>
</ol>
<ul>
<li>The <code>meme_db</code> option can also be set to an R object, like a universalmotif list.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>The <code>MEME_DB</code> environment variable defined in <code>.Renviron</code>
</li>
</ol>
<ul>
<li>The <code>MEME_DB</code> variable will only accept a path to a .meme file</li>
</ul>
<p><strong>NOTE:</strong> if an invalid location is found at one option, <code><a href="../reference/runTomTom.html">runTomTom()</a></code> will fall back to the next location if valid (eg if the <code>meme_db</code> option is set to an invalid file, but the <code>MEME_DB</code> environment variable is a valid file, the <code>MEME_DB</code> path will be used.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>meme_db <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/db/fly_factor_survey_id.meme"</span>, package <span class="op">=</span> <span class="st">"memes"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="input-types" class="section level2">
<h2 class="hasAnchor">
<a href="#input-types" class="anchor"></a>Input types</h2>
<p>To use TomTom on existing motifs, <code><a href="../reference/runTomTom.html">runTomTom()</a></code> will accept any motifs in <code>universalmotif</code> format. The <code>universalmotif</code> package provides several utilities for importing data from various sources.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/universalmotif/" class="external-link">universalmotif</a></span><span class="op">)</span>
<span class="va">example_motif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/universalmotif/man/create_motif.html" class="external-link">create_motif</a></span><span class="op">(</span><span class="st">"CCRAAAW"</span><span class="op">)</span>
<span class="fu"><a href="../reference/runTomTom.html">runTomTom</a></span><span class="op">(</span><span class="va">example_motif</span><span class="op">)</span></code></pre></div>
<p><code><a href="../reference/runTomTom.html">runTomTom()</a></code> can also take the output of <code>runDreme</code> as input. This allows users to easily discover denovo motifs, then match them to as set of known motifs. When run on the output of <code>runDreme</code>, all <code><a href="../reference/runTomTom.html">runTomTom()</a></code> output columns will be appended to the <code><a href="../reference/runDreme.html">runDreme()</a></code> output data.frame, so no information will be lost.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dreme_example"</span><span class="op">)</span>
<span class="fu"><a href="../reference/runTomTom.html">runTomTom</a></span><span class="op">(</span><span class="va">dreme_example</span><span class="op">)</span> </code></pre></div>
</div>
<div id="output-data" class="section level2">
<h2 class="hasAnchor">
<a href="#output-data" class="anchor"></a>Output data</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This is a pre-build dataset packaged with memes </span>
<span class="co"># that mirrors running:</span>
<span class="co"># options(meme_db = system.file("inst/extdata/db/fly_factor_survey_id.meme", package = "memes"))</span>
<span class="co"># example_motif &lt;- create_motif("CCRAAAW")</span>
<span class="co"># example_tomtom &lt;- runTomTom(example_motif)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_tomtom"</span><span class="op">)</span></code></pre></div>
<p>When run using a <code>universalmotif</code> object as input, <code>runTomTom</code> returns the following columns:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">example_tomtom</span><span class="op">)</span>
<span class="co">#&gt;  [1] "motif"              "name"               "altname"           </span>
<span class="co">#&gt;  [4] "family"             "organism"           "consensus"         </span>
<span class="co">#&gt;  [7] "alphabet"           "strand"             "icscore"           </span>
<span class="co">#&gt; [10] "nsites"             "bkgsites"           "pval"              </span>
<span class="co">#&gt; [13] "qval"               "eval"               "type"              </span>
<span class="co">#&gt; [16] "bkg"                "best_match_name"    "best_match_altname"</span>
<span class="co">#&gt; [19] "best_db_name"       "best_match_offset"  "best_match_pval"   </span>
<span class="co">#&gt; [22] "best_match_eval"    "best_match_qval"    "best_match_strand" </span>
<span class="co">#&gt; [25] "best_match_motif"   "tomtom"</span></code></pre></div>
<p>Columns preappended with <code>best_</code> indicate the data corresponding to the best match to the motif listed in <code>name</code>.</p>
<p>The <code>tomtom</code> column is a special column which contains a nested <code>data.frame</code> of the rank-order list of TomTom hits for the motif listed in <code>name</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">example_tomtom</span><span class="op">$</span><span class="va">tomtom</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] "match_name"    "match_altname" "match_motif"   "db_name"      </span>
<span class="co">#&gt; [5] "match_offset"  "match_pval"    "match_eval"    "match_qval"   </span>
<span class="co">#&gt; [9] "match_strand"</span></code></pre></div>
<p>The <code>best_match_motif</code> column contains the universalmotif representation of the best match motif.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/universalmotif/" class="external-link">universalmotif</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/universalmotif/man/view_motifs.html" class="external-link">view_motifs</a></span><span class="op">(</span><span class="va">example_tomtom</span><span class="op">$</span><span class="va">best_match_motif</span><span class="op">)</span></code></pre></div>
<p><img src="core_tomtom_files/figure-html/unnamed-chunk-8-1.png" width="480"></p>
<p>The <code>match_motif</code> column of <code>tomtom</code> contains the universalmotif format motif from the database corresponding to each match in descending order.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_tomtom</span><span class="op">$</span><span class="va">tomtom</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">match_motif</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/universalmotif/man/view_motifs.html" class="external-link">view_motifs</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="core_tomtom_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
<p>The <code><a href="../reference/drop_best_match.html">drop_best_match()</a></code> function drops all the <code>best_match_*</code> columns from the <code><a href="../reference/runTomTom.html">runTomTom()</a></code> output.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_tomtom</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/drop_best_match.html">drop_best_match</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">names</span>
<span class="co">#&gt;  [1] "motif"     "name"      "altname"   "family"    "organism"  "consensus"</span>
<span class="co">#&gt;  [7] "alphabet"  "strand"    "icscore"   "nsites"    "bkgsites"  "pval"     </span>
<span class="co">#&gt; [13] "qval"      "eval"      "type"      "bkg"       "tomtom"</span></code></pre></div>
<p>To unnest the <code>tomtom</code> data.frame column, use <code><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">tidyr::unnest()</a></code>. The <code><a href="../reference/drop_best_match.html">drop_best_match()</a></code> function can be useful when doing this to clean up the unnested data.frame.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unnested</span> <span class="op">&lt;-</span> <span class="va">example_tomtom</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/drop_best_match.html">drop_best_match</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">tomtom</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">unnested</span><span class="op">)</span>
<span class="co">#&gt;  [1] "motif"         "name"          "altname"       "family"       </span>
<span class="co">#&gt;  [5] "organism"      "consensus"     "alphabet"      "strand"       </span>
<span class="co">#&gt;  [9] "icscore"       "nsites"        "bkgsites"      "pval"         </span>
<span class="co">#&gt; [13] "qval"          "eval"          "type"          "bkg"          </span>
<span class="co">#&gt; [17] "match_name"    "match_altname" "match_motif"   "db_name"      </span>
<span class="co">#&gt; [21] "match_offset"  "match_pval"    "match_eval"    "match_qval"   </span>
<span class="co">#&gt; [25] "match_strand"</span></code></pre></div>
<p>To re-nest the tomtom results, use <code><a href="../reference/nest_tomtom.html">nest_tomtom()</a></code> (Note: that <code>best_match_</code> columns will be automatically updated based on the rank-order of the <code>tomtom</code> data.frame)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unnested</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/nest_tomtom.html">nest_tomtom</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">names</span>
<span class="co">#&gt;  [1] "name"               "altname"            "family"            </span>
<span class="co">#&gt;  [4] "organism"           "consensus"          "alphabet"          </span>
<span class="co">#&gt;  [7] "strand"             "icscore"            "nsites"            </span>
<span class="co">#&gt; [10] "bkgsites"           "pval"               "qval"              </span>
<span class="co">#&gt; [13] "eval"               "type"               "bkg"               </span>
<span class="co">#&gt; [16] "best_match_name"    "best_match_altname" "best_match_motif"  </span>
<span class="co">#&gt; [19] "best_db_name"       "best_match_offset"  "best_match_pval"   </span>
<span class="co">#&gt; [22] "best_match_eval"    "best_match_qval"    "best_match_strand" </span>
<span class="co">#&gt; [25] "motif"              "tomtom"</span></code></pre></div>
<div id="manipulating-the-assigned-best-match" class="section level3">
<h3 class="hasAnchor">
<a href="#manipulating-the-assigned-best-match" class="anchor"></a>Manipulating the assigned best match</h3>
<p>While TomTom can be useful for limiting the search-space for potential true motif matches, often times the default “best match” is not the correct assignment. Users should use their domain-specific knowledge in conjunction with the data returned by TomTom to make this judgement (see below for more details). memes provides a few convenience functions for reassigning these values.</p>
<p>First, the <code><a href="../reference/update_best_match.html">update_best_match()</a></code> function will update the values of the <code>best_match*</code> columns to reflect the values stored in the first row of the <code>tomtom</code> data.frame entry. This means that <strong>the rank of the <code>tomtom</code> data is meaningful</strong>, and users should only manipulate it if intending to create side-effects.</p>
<p>If the user can force motifs to contain a certain motif as their best match using the <code><a href="../reference/force_best_match.html">force_best_match()</a></code> function. <code><a href="../reference/force_best_match.html">force_best_match()</a></code> takes a named vector as input, where the name corresponds to the input motif <code>name</code>, and the value corresponds to a <code>match_name</code> found in the <code>tomtom</code> list data (<strong>NOTE:</strong> this means that users cannot force the best match to be a motif that TomTom did not return as a potential match).</p>
<p>For example, below the example motif could match either “Eip93F_SANGER_10”, or “Lag1_Cell”.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_tomtom</span><span class="op">$</span><span class="va">tomtom</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;         match_name match_altname</span>
<span class="co">#&gt; 1 Eip93F_SANGER_10        Eip93F</span>
<span class="co">#&gt; 2        Lag1_Cell       schlank</span>
<span class="co">#&gt; 3     pho_SOLEXA_5           pho</span>
<span class="co">#&gt;                                                            match_motif</span>
<span class="co">#&gt; 1 &lt;S4 class 'universalmotif' [package "universalmotif"] with 20 slots&gt;</span>
<span class="co">#&gt; 2 &lt;S4 class 'universalmotif' [package "universalmotif"] with 20 slots&gt;</span>
<span class="co">#&gt; 3 &lt;S4 class 'universalmotif' [package "universalmotif"] with 20 slots&gt;</span>
<span class="co">#&gt;                   db_name match_offset match_pval match_eval match_qval</span>
<span class="co">#&gt; 1 flyFactorSurvey_cleaned            4   8.26e-07   0.000459   0.000919</span>
<span class="co">#&gt; 2 flyFactorSurvey_cleaned            3   1.85e-03   1.030000   0.781000</span>
<span class="co">#&gt; 3 flyFactorSurvey_cleaned            1   2.54e-03   1.410000   0.781000</span>
<span class="co">#&gt;   match_strand</span>
<span class="co">#&gt; 1            +</span>
<span class="co">#&gt; 2            +</span>
<span class="co">#&gt; 3            +</span></code></pre></div>
<p>The current best match is listed as “Eip93F_SANGER_10”.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_tomtom</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">best_match_name</span><span class="op">)</span>
<span class="co">#&gt;            name  best_match_name</span>
<span class="co">#&gt; 1 example_motif Eip93F_SANGER_10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [WARNING: detected errors. Run update_motifs() or to_list() for</span>
<span class="co">#&gt;   information.]</span></code></pre></div>
<p>To force “example_motif” to have the best match as “Lag1_Cell”, do the following:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_tomtom</span> <span class="op">&lt;-</span> <span class="va">example_tomtom</span> <span class="op">%&gt;%</span> 
  <span class="co"># multiple motifs can be updated at a time by passing additional name-value pairs.</span>
  <span class="fu"><a href="../reference/force_best_match.html">force_best_match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"example_motif"</span> <span class="op">=</span> <span class="st">"Lag1_Cell"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The <code>best_match_*</code> columns will be updated to reflect the modifications.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># original best match:</span>
<span class="va">example_tomtom</span><span class="op">$</span><span class="va">best_match_name</span>
<span class="co">#&gt; [1] "Eip93F_SANGER_10"</span>
<span class="co"># new best match after forcing:</span>
<span class="va">new_tomtom</span><span class="op">$</span><span class="va">best_match_name</span>
<span class="co">#&gt; [1] "Lag1_Cell"</span></code></pre></div>
</div>
</div>
<div id="visualize-data" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-data" class="anchor"></a>Visualize data</h2>
<p><code><a href="../reference/view_tomtom_hits.html">view_tomtom_hits()</a></code> can be used to compare the hits from tomtom to each input motif. Hits are shown in descending order by rank. By default, all hits are shown, or the user can pass an integer to <code>top_n</code> to view the top number of motifs. This can be a useful plot for determining which of the matches appear to be the “best” hit.</p>
<p>For example, it appears that indeed “Eip93F_SANGER_10” is the best of the top 3 hits, as most of the matching sequences in the “Lag1_Cell” and “pho_SOLEXA_5” motifs correspond to low information-content regions of the matched motifs.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_tomtom</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/view_tomtom_hits.html">view_tomtom_hits</a></span><span class="op">(</span>top_n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span></code></pre></div>
<p><img src="core_tomtom_files/figure-html/unnamed-chunk-17-1.png" width="480"></p>
</div>
<div id="importing-previous-data" class="section level2">
<h2 class="hasAnchor">
<a href="#importing-previous-data" class="anchor"></a>Importing previous data</h2>
<p><code><a href="../reference/importTomTomXML.html">importTomTomXML()</a></code> can be used to import a <code>tomtom.xml</code> file from a previous run on the MEME server or on the commandline. Details for how to save data from the TomTom webserver are below.</p>
<div id="saving-data-from-tomtom-web-server" class="section level3">
<h3 class="hasAnchor">
<a href="#saving-data-from-tomtom-web-server" class="anchor"></a>Saving data from TomTom Web Server</h3>
<p>To download XML data from the MEME Server, right-click the TomTom XML output link and “Save Target As” or “Save Link As” (see example image below), and save as <code>&lt;filename&gt;.xml</code>. This file can be read using <code><a href="../reference/importTomTomXML.html">importTomTomXML()</a></code></p>
<p><img src="save_tomtom.png"></p>
</div>
</div>
<div id="citation" class="section level1">
<h1 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h1>
<p>memes is a wrapper for a select few tools from the MEME Suite, which were developed by another group. In addition to citing memes, please cite the MEME Suite tools corresponding to the tools you use.</p>
<p>If you use <code><a href="../reference/runTomTom.html">runTomTom()</a></code> in your analysis, please cite:</p>
<p>Shobhit Gupta, JA Stamatoyannopolous, Timothy Bailey and William Stafford Noble, “Quantifying similarity between motifs”, Genome Biology, 8(2):R24, 2007. <a href="http://genomebiology.com/2007/8/2/R24" class="external-link">full text</a></p>
<div id="licensing-restrictions" class="section level2">
<h2 class="hasAnchor">
<a href="#licensing-restrictions" class="anchor"></a>Licensing Restrictions</h2>
<p>The MEME Suite is free for non-profit use, but for-profit users should purchase a license. See the <a href="http://meme-suite.org/doc/copyright.html" class="external-link">MEME Suite Copyright Page</a> for details.</p>
</div>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R Under development (unstable) (2021-03-18 r80099)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 20.04.2 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] universalmotif_1.9.37 magrittr_2.0.1        memes_0.99.3         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] Rcpp_1.0.6             tidyr_1.1.3            Biostrings_2.59.2     </span>
<span class="co">#&gt;  [4] ggseqlogo_0.1          rprojroot_2.0.2        digest_0.6.27         </span>
<span class="co">#&gt;  [7] utf8_1.2.1             R6_2.5.0               GenomeInfoDb_1.27.8   </span>
<span class="co">#&gt; [10] stats4_4.1.0           evaluate_0.14          ggplot2_3.3.3         </span>
<span class="co">#&gt; [13] highr_0.8              pillar_1.5.1           zlibbioc_1.37.0       </span>
<span class="co">#&gt; [16] rlang_0.4.10           jquerylib_0.1.3        S4Vectors_0.29.9      </span>
<span class="co">#&gt; [19] rmarkdown_2.7          pkgdown_1.6.1.9001     textshaping_0.3.3     </span>
<span class="co">#&gt; [22] desc_1.3.0             readr_1.4.0            stringr_1.4.0         </span>
<span class="co">#&gt; [25] RCurl_1.98-1.3         munsell_0.5.0          compiler_4.1.0        </span>
<span class="co">#&gt; [28] xfun_0.22              pkgconfig_2.0.3        systemfonts_1.0.1     </span>
<span class="co">#&gt; [31] BiocGenerics_0.37.1    htmltools_0.5.1.1      tidyselect_1.1.0      </span>
<span class="co">#&gt; [34] tibble_3.1.0           GenomeInfoDbData_1.2.4 IRanges_2.25.6        </span>
<span class="co">#&gt; [37] matrixStats_0.58.0     fansi_0.4.2            crayon_1.4.1          </span>
<span class="co">#&gt; [40] dplyr_1.0.5            MASS_7.3-53.1          bitops_1.0-6          </span>
<span class="co">#&gt; [43] grid_4.1.0             jsonlite_1.7.2         gtable_0.3.0          </span>
<span class="co">#&gt; [46] lifecycle_1.0.0        scales_1.1.1           stringi_1.5.3         </span>
<span class="co">#&gt; [49] cachem_1.0.4           farver_2.1.0           XVector_0.31.1        </span>
<span class="co">#&gt; [52] fs_1.5.0               bslib_0.2.4            ellipsis_0.3.1        </span>
<span class="co">#&gt; [55] ragg_1.1.2             generics_0.1.0         vctrs_0.3.7           </span>
<span class="co">#&gt; [58] tools_4.1.0            glue_1.4.2             purrr_0.3.4           </span>
<span class="co">#&gt; [61] hms_1.0.0              parallel_4.1.0         fastmap_1.1.0         </span>
<span class="co">#&gt; [64] yaml_2.2.1             colorspace_2.0-0       GenomicRanges_1.43.3  </span>
<span class="co">#&gt; [67] memoise_2.0.0          knitr_1.31             sass_0.3.1</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Spencer Nystrom.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
